# 这一部分是配置文件
# 功能是 统一管理所有配置项
import os

# ==========API 配置==========
DASHSCOPE_API_KEY = "sk-97a5c56b52304c92abc6cd5646185eab"

# ========== 模型配置==========
LLM_MODEL = "qwen-turbo"    # 选择千问模型
EMBEDDING_MODEL = "paraphrase-multilingual-MiniLM-L12-v2"    # 选择向量模型就是把文本转成向量的模型
TEMPERATURE = 0.7  # 创造力参数

# ========== 数据库配置 ==========
CHROMA_DB_PATH = "./data/chroma_db"    # 向量数据库路径，存放向量数据
COLLECTION_NAME = "agri_knowledge"     # 集合名称，作用类似于数据库中的表

# ========== RAG配置 ==========
N_RESULTS = 3 # 检索结果数量
SIMILARITY_THRESHOLD = 0.3 # 相似度阈值,作用是过滤掉不相关的内容，取值范围0-1,值越大，要求越严格

# ========== 对话配置 ==========
MAX_HISTORY = 10  # 最大对话历史长度

# ========== 提示词配置 ==========
SYSTEM_PROMPT = (
    '''
    你是农宝🌾， 一位深耕农业的ai助手， 主要服务于高校师生学习农学， 以及帮助农民伯伯解决农事问题。
    【你的专长】
- 擅长各种作物如小麦、水稻、玉米、大豆等，
- 熟悉农业技术、病虫害防治、土壤管理、农业机械化等领域的知识，
- 能够为农民提供实用的农业建议和解决方案。
    【回答要求】
    1. 回答要简洁明了，避免使用专业术语。
    2. 优先基于知识库中的参考资料回答
    3. 如果资料不足，可以补充你的专业知识，但要说明
    4. 语言通俗易懂，200-300字
    5. 结构清晰，适当使用emoji
    6. 注明信息来源
    '''
)

# ========== RAG 提示词配置模板 ==========
RAG_PROMPT_TEMPLATE = (
    '''
你是农宝🌾，一位在农业方面有所专长， 同时也是灵活实用的ai助手

【参考资料】
{context}

【对话历史】
{chat_history}

【用户问题】
{question}

【回答策略】⭐⭐⭐ 重点修改
1. **优先使用参考资料**：如果参考资料相关，优先基于资料回答
2. **补充专业知识**：如果资料不够全面，结合你的农业专业知识补充
3. **通用知识兜底**：如果参考资料完全不相关，基于你的通用农业知识回答
4. **诚实表达**：如果确实不了解，诚实说明，并建议用户查阅专业资料
5. **灵活应变**：根据用户的反馈和需求，调整回答策略, 但同时要让用户知道你的专长是农业

【回答要求】
- 语言通俗易懂，但又不失专业性
- 结构清晰，适当使用emoji
- 如果使用了参考资料，注明来源
- 如果是你的专业知识，说明"基于通用农业知识"

请回答：
    '''
)

# ========== 显示配置 ==========
def show_config():
    """显示当前配置"""
    print("="*60)
    print("📋 系统配置")
    print("="*60)
    print(f"模型：{LLM_MODEL}")
    print(f"向量模型：{EMBEDDING_MODEL}")
    print(f"数据库路径：{CHROMA_DB_PATH}")
    print(f"检索文档数：{N_RESULT}")
    print(f"相似度阈值：{SIMILARITY_THRESHOLD}")
    print(f"记忆窗口：{MAX_HISTORY}轮")
    print("="*60)

if __name__ == "__main__":
    show_config()